(function(document){"use strict";var autoplayDefault=0;var currentStepTimeout=0;var api=null;var timeoutHandle=null;var root=null;var util;document.addEventListener("impress:init",function(event){util=event.detail.api.lib.util;api=event.detail.api;root=event.target;var data=root.dataset;if(data.autoplay){autoplayDefault=util.toNumber(data.autoplay,0)}var toolbar=document.querySelector("#impress-toolbar");if(toolbar){addToolbarButton(toolbar)}api.lib.gc.pushCallback(function(){clearTimeout(timeoutHandle)})},false);var reloadTimeout=function(event){var step=event.target;currentStepTimeout=util.toNumber(step.dataset.autoplay,autoplayDefault);if(status==="paused"){setAutoplayTimeout(0)}else{setAutoplayTimeout(currentStepTimeout)}};document.addEventListener("impress:stepenter",function(event){reloadTimeout(event)},false);document.addEventListener("impress:substep:stepleaveaborted",function(event){reloadTimeout(event)},false);var setAutoplayTimeout=function(timeout){if(timeoutHandle){clearTimeout(timeoutHandle)}if(timeout>0){timeoutHandle=setTimeout(function(){api.next()},timeout*1e3)}setButtonText()};var status="not clicked";var toolbarButton=null;var triggerEvent=function(el,eventName,detail){var event=document.createEvent("CustomEvent");event.initCustomEvent(eventName,true,true,detail);el.dispatchEvent(event)};var makeDomElement=function(html){var tempDiv=document.createElement("div");tempDiv.innerHTML=html;return tempDiv.firstChild};var toggleStatus=function(){if(currentStepTimeout>0&&status!=="paused"){status="paused"}else{status="playing"}};var getButtonText=function(){if(currentStepTimeout>0&&status!=="paused"){return"||"}else{return"&#9654;"}};var setButtonText=function(){if(toolbarButton){var buttonWidth=toolbarButton.offsetWidth;var buttonHeight=toolbarButton.offsetHeight;toolbarButton.innerHTML=getButtonText();if(!toolbarButton.style.width){toolbarButton.style.width=buttonWidth+"px"}if(!toolbarButton.style.height){toolbarButton.style.height=buttonHeight+"px"}}};var addToolbarButton=function(toolbar){var html='<button id="impress-autoplay-playpause" '+'title="Autoplay" class="impress-autoplay">'+getButtonText()+"</button>";toolbarButton=makeDomElement(html);toolbarButton.addEventListener("click",function(){toggleStatus();if(status==="playing"){if(autoplayDefault===0){autoplayDefault=7}if(currentStepTimeout===0){currentStepTimeout=autoplayDefault}setAutoplayTimeout(currentStepTimeout)}else if(status==="paused"){setAutoplayTimeout(0)}});triggerEvent(toolbar,"impress:toolbar:appendChild",{group:10,element:toolbarButton})}})(document);