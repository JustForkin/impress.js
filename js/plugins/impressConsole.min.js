(function(document,window){"use strict";var triggerEvent=function(el,eventName,detail){var event=document.createEvent("CustomEvent");event.initCustomEvent(eventName,true,true,detail);el.dispatchEvent(event)};var lang;switch(navigator.language){case"de":lang={noNotes:'<div class="noNotes">Keine Notizen hierzu</div>',restart:"Neustart",clickToOpen:"Klicken um Sprecherkonsole zu öffnen",prev:"zurück",next:"weiter",loading:"initalisiere",ready:"Bereit",moving:"in Bewegung",useAMPM:false};break;case"en":default:lang={noNotes:'<div class="noNotes">No notes for this step</div>',restart:"Restart",clickToOpen:"Click to open speaker console",prev:"Prev",next:"Next",loading:"Loading",ready:"Ready",moving:"Moving",useAMPM:false};break}const preViewDefaultFactor=.7;const preViewMinimumFactor=.5;const preViewGap=4;const consoleTemplate="<!DOCTYPE html>"+'<html id="impressconsole"><head>'+"{{cssStyle}}"+"{{cssLink}}"+"</head><body>"+'<div id="console">'+'<div id="views">'+'<iframe id="slideView" scrolling="no"></iframe>'+'<iframe id="preView" scrolling="no"></iframe>'+'<div id="blocker"></div>'+"</div>"+'<div id="notes"></div>'+"</div>"+'<div id="controls"> '+'<div id="prev"><a  href="#" onclick="impress().prev(); return false;" />'+"{{prev}}</a></div>"+'<div id="next"><a  href="#" onclick="impress().next(); return false;" />'+"{{next}}</a></div>"+'<div id="clock">--:--</div>'+'<div id="timer" onclick="timerReset()">00m 00s</div>'+'<div id="status">{{loading}}</div>'+"</div>"+"</body></html>";var cssFileOldDefault="css/impressConsole.css";var cssFile=undefined;var cssFileIframeOldDefault="css/iframe.css";var cssFileIframe=undefined;var allConsoles={};var zeroPad=function(i){return(i<10?"0":"")+i};var impressConsole=window.impressConsole=function(rootId){rootId=rootId||"impress";if(allConsoles[rootId]){return allConsoles[rootId]}var root=document.getElementById(rootId);var consoleWindow=null;var nextStep=function(){var classes="";var nextElement=document.querySelector(".active");while(!nextElement.nextElementSibling&&nextElement.parentNode){nextElement=nextElement.parentNode}nextElement=nextElement.nextElementSibling;while(nextElement){classes=nextElement.attributes["class"];if(classes&&classes.value.indexOf("step")!==-1){consoleWindow.document.getElementById("blocker").innerHTML=lang.next;return nextElement}if(nextElement.firstElementChild){nextElement=nextElement.firstElementChild}else{while(!nextElement.nextElementSibling&&nextElement.parentNode){nextElement=nextElement.parentNode}nextElement=nextElement.nextElementSibling}}consoleWindow.document.getElementById("blocker").innerHTML=lang.restart;return document.querySelector(".step")};var onStepLeave=function(){if(consoleWindow){var newNotes=document.querySelector(".active").querySelector(".notes");if(newNotes){newNotes=newNotes.innerHTML}else{newNotes=lang.noNotes}consoleWindow.document.getElementById("notes").innerHTML=newNotes;var baseURL=document.URL.substring(0,document.URL.search("#/"));var slideSrc=baseURL+"#"+document.querySelector(".active").id;var preSrc=baseURL+"#"+nextStep().id;var slideView=consoleWindow.document.getElementById("slideView");if(slideView.src!==slideSrc){slideView.src=slideSrc}var preView=consoleWindow.document.getElementById("preView");if(preView.src!==preSrc){preView.src=preSrc}consoleWindow.document.getElementById("status").innerHTML='<span class="moving">'+lang.moving+"</span>"}};var onStepEnter=function(){if(consoleWindow){var newNotes=document.querySelector(".active").querySelector(".notes");if(newNotes){newNotes=newNotes.innerHTML}else{newNotes=lang.noNotes}var notes=consoleWindow.document.getElementById("notes");notes.innerHTML=newNotes;notes.scrollTop=0;var baseURL=document.URL.substring(0,document.URL.search("#/"));var slideSrc=baseURL+"#"+document.querySelector(".active").id;var preSrc=baseURL+"#"+nextStep().id;var slideView=consoleWindow.document.getElementById("slideView");if(slideView.src!==slideSrc){slideView.src=slideSrc}var preView=consoleWindow.document.getElementById("preView");if(preView.src!==preSrc){preView.src=preSrc}consoleWindow.document.getElementById("status").innerHTML='<span  class="ready">'+lang.ready+"</span>"}};var onSubstep=function(event){if(consoleWindow){if(event.detail.reason==="next"){onSubstepShow()}if(event.detail.reason==="prev"){onSubstepHide()}}};var onSubstepShow=function(){var slideView=consoleWindow.document.getElementById("slideView");triggerEventInView(slideView,"impress:substep:show")};var onSubstepHide=function(){var slideView=consoleWindow.document.getElementById("slideView");triggerEventInView(slideView,"impress:substep:hide")};var triggerEventInView=function(frame,eventName,detail){var event=frame.contentDocument.createEvent("CustomEvent");event.initCustomEvent(eventName,true,true,detail);frame.contentDocument.dispatchEvent(event)};var spaceHandler=function(){var notes=consoleWindow.document.getElementById("notes");if(notes.scrollTopMax-notes.scrollTop>20){notes.scrollTop=notes.scrollTop+notes.clientHeight*.8}else{window.impress().next()}};var timerReset=function(){consoleWindow.timerStart=new Date};var clockTick=function(){var now=new Date;var hours=now.getHours();var minutes=now.getMinutes();var seconds=now.getSeconds();var ampm="";if(lang.useAMPM){ampm=hours<12?"AM":"PM";hours=hours>12?hours-12:hours;hours=hours===0?12:hours}var clockStr=zeroPad(hours)+":"+zeroPad(minutes)+":"+zeroPad(seconds)+" "+ampm;consoleWindow.document.getElementById("clock").firstChild.nodeValue=clockStr;seconds=Math.floor((now-consoleWindow.timerStart)/1e3);minutes=Math.floor(seconds/60);seconds=Math.floor(seconds%60);consoleWindow.document.getElementById("timer").firstChild.nodeValue=zeroPad(minutes)+"m "+zeroPad(seconds)+"s";if(!consoleWindow.initialized){consoleWindow.document.getElementById("slideView").contentWindow.scrollTo(0,0);consoleWindow.document.getElementById("preView").contentWindow.scrollTo(0,0);consoleWindow.initialized=true}};var registerKeyEvent=function(keyCodes,handler,window){if(window===undefined){window=consoleWindow}window.document.addEventListener("keydown",function(event){if(!event.ctrlKey&&!event.altKey&&!event.shiftKey&&!event.metaKey&&keyCodes.indexOf(event.keyCode)!==-1){event.preventDefault()}},false);window.document.addEventListener("keyup",function(event){if(!event.ctrlKey&&!event.altKey&&!event.shiftKey&&!event.metaKey&&keyCodes.indexOf(event.keyCode)!==-1){handler();event.preventDefault()}},false)};var consoleOnLoad=function(){var slideView=consoleWindow.document.getElementById("slideView");var preView=consoleWindow.document.getElementById("preView");slideView.contentDocument.body.classList.add("impress-console");preView.contentDocument.body.classList.add("impress-console");if(cssFileIframe!==undefined){slideView.contentDocument.head.insertAdjacentHTML("beforeend",'<link rel="stylesheet" type="text/css" href="'+cssFileIframe+'">');preView.contentDocument.head.insertAdjacentHTML("beforeend",'<link rel="stylesheet" type="text/css" href="'+cssFileIframe+'">')}slideView.addEventListener("load",function(){slideView.contentDocument.body.classList.add("impress-console");if(cssFileIframe!==undefined){slideView.contentDocument.head.insertAdjacentHTML("beforeend",'<link rel="stylesheet" type="text/css" href="'+cssFileIframe+'">')}});preView.addEventListener("load",function(){preView.contentDocument.body.classList.add("impress-console");if(cssFileIframe!==undefined){preView.contentDocument.head.insertAdjacentHTML("beforeend",'<link rel="stylesheet" type="text/css" href="'+cssFileIframe+'">')}})};var open=function(){if(top.isconsoleWindow){return}if(consoleWindow&&!consoleWindow.closed){consoleWindow.focus()}else{consoleWindow=window.open("","impressConsole");if(consoleWindow==null){var message=document.createElement("div");message.id="consoleWindowError";message.style.position="fixed";message.style.left=0;message.style.top=0;message.style.right=0;message.style.bottom=0;message.style.backgroundColor="rgba(255, 255, 255, 0.9)";var onClickStr="var x = document.getElementById('consoleWindowError');"+"x.parentNode.removeChild(x);impressConsole().open();";message.innerHTML='<button style="margin: 25vh 25vw;width:50vw;height:50vh;'+'onclick="'+onClickStr+'">'+lang.clickToOpen+"</button>";document.body.appendChild(message);return}var cssLink="";if(cssFile!==undefined){cssLink='<link rel="stylesheet" type="text/css" media="screen" href="'+cssFile+'">'}consoleWindow.document.open();consoleWindow.document.write(consoleTemplate.replace("{{cssStyle}}",cssStyleStr()).replace("{{cssLink}}",cssLink).replace(/{{.*?}}/gi,function(x){return lang[x.substring(2,x.length-2)]}));consoleWindow.document.title="Speaker Console ("+document.title+")";consoleWindow.impress=window.impress;consoleWindow.isconsoleWindow=true;consoleWindow.onload=consoleOnLoad;consoleWindow.timerStart=new Date;consoleWindow.timerReset=timerReset;consoleWindow.clockInterval=setInterval(allConsoles[rootId].clockTick,1e3);registerKeyEvent([33,37,38],window.impress().prev);registerKeyEvent([34,39,40],window.impress().next);registerKeyEvent([32],spaceHandler);registerKeyEvent([82],timerReset);consoleWindow.onbeforeunload=function(){clearInterval(consoleWindow.clockInterval)};onStepEnter();consoleWindow.initialized=false;consoleWindow.document.close();window.onresize=resize;consoleWindow.onresize=resize;return consoleWindow}};var resize=function(){var slideView=consoleWindow.document.getElementById("slideView");var preView=consoleWindow.document.getElementById("preView");var ratio=window.innerHeight/window.innerWidth;var views=consoleWindow.document.getElementById("views");var delta=slideView.offsetWidth-slideView.clientWidth;var slideViewWidth=views.clientWidth-delta;var slideViewHeight=Math.floor(slideViewWidth*ratio);var preViewTop=slideViewHeight+preViewGap;var preViewWidth=Math.floor(slideViewWidth*preViewDefaultFactor);var preViewHeight=Math.floor(slideViewHeight*preViewDefaultFactor);if(views.clientHeight-delta<preViewTop+preViewHeight){preViewHeight=views.clientHeight-delta-preViewTop;preViewWidth=Math.floor(preViewHeight/ratio)}if(preViewWidth<=Math.floor(slideViewWidth*preViewMinimumFactor)){slideViewWidth=views.clientWidth-delta;slideViewHeight=Math.floor((views.clientHeight-delta-preViewGap)/(1+preViewMinimumFactor));preViewTop=slideViewHeight+preViewGap;preViewWidth=Math.floor(slideViewWidth*preViewMinimumFactor);preViewHeight=views.clientHeight-delta-preViewTop}slideView.style.width=slideViewWidth+"px";slideView.style.height=slideViewHeight+"px";preView.style.top=preViewTop+"px";preView.style.width=preViewWidth+"px";preView.style.height=preViewHeight+"px"};var _init=function(cssConsole,cssIframe){if(cssConsole!==undefined){cssFile=cssConsole}else if(root.dataset.consoleCss!==undefined){cssFile=root.dataset.consoleCss}if(cssIframe!==undefined){cssFileIframe=cssIframe}else if(root.dataset.consoleCssIframe!==undefined){cssFileIframe=root.dataset.consoleCssIframe}root.addEventListener("impress:stepleave",onStepLeave);root.addEventListener("impress:stepenter",onStepEnter);root.addEventListener("impress:substep:stepleaveaborted",onSubstep);root.addEventListener("impress:substep:show",onSubstepShow);root.addEventListener("impress:substep:hide",onSubstepHide);window.onunload=function(){if(consoleWindow&&!consoleWindow.closed){consoleWindow.close()}};registerKeyEvent([80],open,window);if(root.dataset.consoleAutolaunch==="true"){window.open()}};var init=function(cssConsole,cssIframe){if((cssConsole===undefined||cssConsole===cssFileOldDefault)&&(cssIframe===undefined||cssIframe===cssFileIframeOldDefault)){window.console.log("impressConsole.init() is deprecated. "+"impressConsole is now initialized automatically when you "+"call impress().init().")}_init(cssConsole,cssIframe)};document.addEventListener("impress:init",function(){_init();triggerEvent(document,"impress:help:add",{command:"P",text:"Presenter console",row:10})});root.addEventListener("impress:console:open",function(){window.open()});root.addEventListener("impress:console:registerKeyEvent",function(event){registerKeyEvent(event.detail.keyCodes,event.detail.handler,event.detail.window)});allConsoles[rootId]={init:init,open:open,clockTick:clockTick,registerKeyEvent:registerKeyEvent};return allConsoles[rootId]};var cssStyleStr=function(){return`<style>\n            #impressconsole body {\n                background-color: rgb(255, 255, 255);\n                padding: 0;\n                margin: 0;\n                font-family: verdana, arial, sans-serif;\n                font-size: 2vw;\n            }\n\n            #impressconsole div#console {\n                position: absolute;\n                top: 0.5vw;\n                left: 0.5vw;\n                right: 0.5vw;\n                bottom: 3vw;\n                margin: 0;\n            }\n\n            #impressconsole div#views, #impressconsole div#notes {\n                position: absolute;\n                top: 0;\n                bottom: 0;\n            }\n\n            #impressconsole div#views {\n                left: 0;\n                right: 50vw;\n                overflow: hidden;\n            }\n\n            #impressconsole div#blocker {\n                position: absolute;\n                right: 0;\n                bottom: 0;\n            }\n\n            #impressconsole div#notes {\n                left: 50vw;\n                right: 0;\n                overflow-x: hidden;\n                overflow-y: auto;\n                padding: 0.3ex;\n                background-color: rgb(255, 255, 255);\n                border: solid 1px rgb(120, 120, 120);\n            }\n\n            #impressconsole div#notes .noNotes {\n                color: rgb(200, 200, 200);\n            }\n\n            #impressconsole div#notes p {\n                margin-top: 0;\n            }\n\n            #impressconsole iframe {\n                position: absolute;\n                margin: 0;\n                padding: 0;\n                left: 0;\n                border: solid 1px rgb(120, 120, 120);\n            }\n\n            #impressconsole iframe#slideView {\n                top: 0;\n                width: 49vw;\n                height: 49vh;\n            }\n\n            #impressconsole iframe#preView {\n                opacity: 0.7;\n                top: 50vh;\n                width: 30vw;\n                height: 30vh;\n            }\n\n            #impressconsole div#controls {\n                margin: 0;\n                position: absolute;\n                bottom: 0.25vw;\n                left: 0.5vw;\n                right: 0.5vw;\n                height: 2.5vw;\n                background-color: rgb(255, 255, 255);\n                background-color: rgba(255, 255, 255, 0.6);\n            }\n\n            #impressconsole div#prev, div#next {\n            }\n\n            #impressconsole div#prev a, #impressconsole div#next a {\n                display: block;\n                border: solid 1px rgb(70, 70, 70);\n                border-radius: 0.5vw;\n                font-size: 1.5vw;\n                padding: 0.25vw;\n                text-decoration: none;\n                background-color: rgb(220, 220, 220);\n                color: rgb(0, 0, 0);\n            }\n\n            #impressconsole div#prev a:hover, #impressconsole div#next a:hover {\n                background-color: rgb(245, 245, 245);\n            }\n\n            #impressconsole div#prev {\n                float: left;\n            }\n\n            #impressconsole div#next {\n                float: right;\n            }\n\n            #impressconsole div#status {\n                margin-left: 2em;\n                margin-right: 2em;\n                text-align: center;\n                float: right;\n            }\n\n            #impressconsole div#clock {\n                margin-left: 2em;\n                margin-right: 2em;\n                text-align: center;\n                float: left;\n            }\n\n            #impressconsole div#timer {\n                margin-left: 2em;\n                margin-right: 2em;\n                text-align: center;\n                float: left;\n            }\n\n            #impressconsole span.moving {\n                color: rgb(255, 0, 0);\n            }\n\n            #impressconsole span.ready {\n                color: rgb(0, 128, 0);\n            }\n        </style>`};impressConsole()})(document,window);